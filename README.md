## Что такое GSpreadsheetEasyAccess?
Библиотека-оболочка над библиотеками Google для быстрого и простого взаимодействия с листами Google таблиц.

## Описание
Оригинальные библиотеки имеют большое количество типов,
но [в примере для .NET](https://developers.google.com/sheets/api/quickstart/dotnet#prerequisites)
можно выделить основные, такие как GoogleWebAuthorizationBroker, SheetsService, Request, ValueRange.
При этом в общей документации по работе с Google Sheets API говорят о вещах на более высоком уровне,
а именно об аутентификации, разнице аккаунтов человека и сервиса, областях действий пользователей и т.д.
В оригинальных библиотеках нет типов и методов отражающих данные понятия.
Нам захотелось увидеть эти понятия и мы отразили их в своей библиотеке.

### Основные типы
- GCPApplication - представляет приложение на Google Cloud Platform у которого подключен
[Google Sheet API](https://developers.google.com/sheets/api?hl=en_US).  
Им можно пользоваться только после аутентификации пользователя.
- Principal - представляет объект, которому можно предоставить доступ к ресурсу.
- OAuthSheetsScope - область действия для аккаунта.
- SheetModel - представляет один лист Google таблицы. Состоит из строк, а строки из ячеек.

Это не все типы, которые есть в библиотеке, они не настолько важные чтобы упоминать их тут.

#### GCPApplication
Основной тип библиотеки с помощью которого можно:
- Аутентифицировать пользователя;
- Получить существующий лист Google таблицы;
- Обновить лист Google таблицы.

#### Principal
Это базовый тип для аутентификации. Есть конкретные, которые нужно использовать в своём коде.

- UserAccount.  
Учетные записи пользователей управляются как учетные записи Google,
они представляют разработчика, администратора или любое другое лицо, взаимодействующее с Google Cloud.
Это для сценариев, когда вашему приложению требуется доступ к ресурсам от имени пользователя.  
Для аккаутна пользователя необходимо задать область действия.
Области OAuth ограничивают действия, которые ваше приложение может выполнять от имени конечного пользователя.
Установите минимальный размер, необходимый для вашего варианта использования.
Класс реализует только часть областей из
[API Google Таблиц v4](https://developers.google.com/identity/protocols/oauth2/scopes#sheets).  
Для получения дополнительной информации см.
[аутентификация конечного пользователя](https://cloud.google.com/docs/authentication/end-user).  

- ServiceAccount.  
Сервисные аккаунты управляются [IAM](https://cloud.google.com/iam/docs/understanding-service-accounts)
и представляют пользователей, не являющихся людьми.
Это для сценариев, когда вашему приложению требуется доступ к ресурсам или
выполнить действия самостоятельно, например запуск приложений App Engine или взаимодействие
с экземплярами Compute Engine.  
Учтите, что сервисному аккаунту Google даёт доступ только на чтение общедоступных таблиц!
Для получения дополнительной информации см.
[аутентификация в качестве сервисного аккаунта](https://cloud.google.com/docs/authentication/api-keys).

#### SheetModel
Тип, состояние которого должно соответствовать желаемому состоянию листа Google таблицы.
Данный тип позволяет:
- Добавлять строки;
- Удалять строки;
- Менять значения в ячейках;
- Проверять валидность шапки.

Все изменения, отражённые на экземпляре SheetModel, укажут экземпляру GCPApplication то
как надо менять данные в листе Google таблицы.

#### Exceptions
БОльщая часть методов выбрасывают исключения. Об этом написано в документации к каждому методу.
Описание исключений находятся только в документации к этим исключениям.
Например метод проверки шапки листа может выбросить InvalidSheetHeadException если в ней не хватает
некоторых заголовков.

## Примеры
В данном репозитории есть папка
[examples](https://github.com/Synergy-Systems-LLC/SynSys.GSpreadsheetEasyAccess/tree/master/examples).  
Там находятся примеры получения и изменения данных в листах Google таблиц на двух языках C# и IronPython.

## Применение в своём проекте
C# разработчикам нужно просто скачать библиотеку с помощью NuGet Package Manager.

IronPython разработчикам нужно:
- Скачать архив с dll в [релизах](https://github.com/BIMOpenGroup/RevitAPIStubs/releases);
- Расположить все dll в папке проекта;
- Подключить с помощью одного из методов модуля clr. Подробности можно увидеть в 
[examples](https://github.com/Synergy-Systems-LLC/SynSys.GSpreadsheetEasyAccess/tree/master/examples/IronPythonApp).  

### IronPython Stubs
Чтобы использовать библиотеку с помощью IronPython с комфортом, нужно воспользоваться
[заглушками](https://github.com/Synergy-Systems-LLC/SynSys.GSpreadsheetEasyAccess/tree/master/stubs).  
Скачать их можно в [релизах](https://github.com/BIMOpenGroup/RevitAPIStubs/releases).  
Если вы ничего не знаете про заглушки, то прочитать про них можно
[тут](https://github.com/BIMOpenGroup/RevitAPIStubs).

## Как я могу внести свой вклад?
Мы приветствуем любой вклад! Пишите вопросы, предложения, замечания.

Как и практически в любом опенсорсе тут принята система Forking Workflow.

Тезисно:
- Делаем форк репозитория;
- Создаём ветку от master;
- Делаем pull request в upstream/master.

Правила именования веток:
- Стиль kebab-case;
- Первым словом идёт задача fix/feature/refactor и т.д. Последующими - краткое описание, либо номер issue.
fix-iss57 / feature-iss14 / refactor-generator.